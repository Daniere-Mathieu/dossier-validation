### C15 - Développer la couche de persistance des données en appliquant les bonnes pratiques de sécurité informatique et de performance

#### C15.1 - Mettre en œuvre et administrer des bases de données relationnelles de manière sécurisée
La mise en œuvre et l'administration des bases de données relationnelles nécessitent une attention particulière à la sécurité et à la performance. Avec TypeORM, il est possible de configurer des connexions sécurisées en utilisant SSL/TLS et de définir des politiques de gestion des utilisateurs et des rôles pour contrôler l'accès aux données.

#### C15.2 - Exploiter et interroger des bases de données relationnelles depuis le backend de l’application
TypeORM facilite l'interrogation et la manipulation des bases de données relationnelles à travers une syntaxe simple et intuitive. Il permet d'exécuter des requêtes SQL, de créer et de gérer des entités et des relations, et d'optimiser les performances des requêtes en utilisant des index et des vues.

```typescript
import { createConnection, getRepository } from "typeorm";
import { User } from "./entity/User";

async function main() {
  try {
    const connection = await createConnection();

    const userRepository = getRepository(User);

    const newUser = new User();
    newUser.firstName = "John";
    newUser.lastName = "Doe";
    newUser.age = 25;
    await userRepository.save(newUser);

    const user = await userRepository.findOne({ firstName: "John" });

    if (user) {
      user.lastName = "Smith";
      await userRepository.save(user);
    }

    if (user) {
      await userRepository.remove(user);
    }
  }
  catch (error) {
    console.error("Error: ", error);
    await connection.close();
  }
}

main();
```

#### C15.3 - Mettre en œuvre et administrer des bases de données NoSQL de manière sécurisée
Bien que TypeORM soit principalement utilisé pour les bases de données relationnelles, il peut également être configuré pour travailler avec des bases de données NoSQL comme MongoDB. La sécurisation de ces bases de données implique l'utilisation de mécanismes d'authentification robustes, la configuration des permissions d'accès, et l'application de politiques de chiffrement des données.

#### C15.4 - Exploiter et interroger des bases de données NoSQL
Pour interagir avec des bases de données NoSQL comme MongoDB, Mongoose est une bibliothèque couramment utilisée dans les applications Node.js. Elle permet de définir des schémas, d'exécuter des requêtes et de manipuler des données de manière efficace.

```javascript
const mongoose = require('mongoose');

// Connexion à la base de données MongoDB
mongoose.connect('mongodb://localhost:27017/mydatabase', { useNewUrlParser: true, useUnifiedTopology: true });

const db = mongoose.connection;
db.on('error', console.error.bind(console, 'connection error:'));
db.once('open', function() {
  
  // Définition du schéma
  const userSchema = new mongoose.Schema({
    firstName: String,
    lastName: String,
    age: Number
  });

  // Création du modèle
  const User = mongoose.model('User', userSchema);

  // Création d'un nouvel utilisateur
  const newUser = new User({ firstName: 'Jane', lastName: 'Doe', age: 28 });
  newUser.save(function (err, user) {
    if (err) return console.error(err);

    // Requête pour trouver un utilisateur par son prénom
    User.findOne({ firstName: 'Jane' }, function (err, user) {
      if (err) return console.error(err);

      // Mise à jour d'un utilisateur
      user.lastName = 'Smith';
      user.save(function (err, updatedUser) {
        if (err) return console.error(err);

        // Suppression d'un utilisateur
        User.deleteOne({ _id: updatedUser._id }, function (err) {
          if (err) return console.error(err);
          
          // Fermeture de la connexion
          mongoose.connection.close();
        });
      });
    });
  });
});
```

#### C15.5 - Faire évoluer les bases de données
La gestion des migrations de bases de données est essentielle pour assurer la continuité et la stabilité des applications. TypeORM propose des outils intégrés pour générer, exécuter et gérer les migrations de schéma, facilitant ainsi l'évolution des bases de données sans interruption du service.

### Remarques
La configuration de la sécurité pour les bases de données, qu'elles soient relationnelles ou NoSQL, doit être prioritaire pour protéger les données sensibles et respecter les réglementations en vigueur.  
L'utilisation de TypeORM simplifie grandement la gestion de la persistance des données, mais il est crucial de bien comprendre ses fonctionnalités et limitations pour tirer pleinement parti de ses capacités.  
La performance des opérations de bases de données peut être améliorée en optimisant les requêtes, en utilisant des index appropriés et en ajustant les configurations du serveur de base de données.

